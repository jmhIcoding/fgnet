# 说明
本文件夹是对BIND论文里面提到的方法进行复现.
论文引用bibtex:
```
@inproceedings{al2016adaptive,
title={Adaptive encrypted traffic fingerprinting with bi-directional dependence},
author={Al-Naami, Khaled and Chandra, Swarup and Mustafa, Ahmad and Khan, Latifur and Lin, Zhiqiang and Hamlen, Kevin and Thuraisingham, Bhavani},
booktitle={Proceedings of the 32nd Annual Conference on Computer Security Applications},
pages={177--188},
year={2016}
}
```
# 数据集样式
向量化前,每条流具有的特征:
```
BIND_Feature_Raw={
    'Dn-Up-Burst-Size':{(x,y):counter},#先Down再Up的burst size依次为x,y的次数
    'Dn-Up-Burst-Time':{(x,y):counter},#先Down再Up的burst 持续时间依次为x,y的次数,(只保留2位有效数字)
    'Up-Dn-Burst-Size':{(x,y):counter},#先Up再Down的burst size依次为x,y的次数
    'Up-Dn-Burst-Time':{(x,y):counter},#先Up再Down的burst 持续时间依次为x,y的次数,(只保留2位有效数字)
    'Uni-Burst-Size':{x:counter},#单个burst size的出现次数的统计
    'Uni-Burst-Time':{x:counter},#单个burst size持续时间的统计
    'Pkt-Size':{x:counter},#包长的出现次数的统计
}
```
样例:
```
{'Dn-Up-size': {(1425, 176): 1, (2317, 184): 1, (2988, 191): 1, (2014, 197): 1, (1862, 173): 1, (7616, 191): 1, (4685, 192): 1, (2832, 185): 1, (2301, 197): 1, (5750, 180): 1, (2565, 200): 1, (3803, 178): 1, (3816, 181): 1, (2485, 181): 2, (2178, 200): 1, (2578, 200): 1, (2571, 199): 1, (2676, 186): 1, (2335, 185): 1, (4167, 200): 1, (5062, 200): 1, (5062, 167): 1, (2499, 167): 1, (2499, 182): 1, (2729, 200): 1, (2619, 192): 1, (4019, 211): 1, (2612, 211): 1, (2612, 210): 1, (3812, 194): 1, (3010, 194): 1, (3004, 169): 1, (2854, 177): 1, (3442, 177): 1, (3449, 178): 1, (2261, 183): 1, (1343, 183): 1, (1343, 169): 1}, 'Dn-Up-time': {(0.02, 1.03): 1, (0.08, 0.22): 1, (0.02, 0.3): 1, (0.05, 0.81): 1, (0.05, -0.62): 1, (0.01, 0.11): 2, (0.02, 0.0): 1, (0.07, 0.02): 1, (0.03, 0.76): 1, (0.0, 0.07): 1, (0.03, 0.12): 1, (0.08, 0.1): 1, (0.0, 0.04): 1, (0.01, 0.06): 1, (0.02, 0.69): 1, (0.0, -0.51): 1, (0.03, 0.05): 1, (0.04, 0.01): 1, (0.0, 0.11): 1, (0.04, 0.13): 1, (0.0, 0.0): 1, (0.11, 0.0): 2, (0.0, 0.09): 1, (0.01, 0.01): 2, (0.04, 0.09): 1, (0.3, 0.27): 1, (-0.42, 0.0): 1, (0.11, 0.01): 1, (0.1, 0.0): 1, (0.03, 0.06): 1, (0.0, 0.05): 1, (0.09, 0.0): 1, (0.0, 0.1): 1, (0.01, 0.59): 1, (0.36, -0.68): 1, (0.01, 1.32): 1}, 'Up-Dn-size': {(167, 1425): 1, (176, 2317): 1, (184, 2988): 1, (191, 2014): 1, (197, 1862): 1, (173, 7616): 1, (191, 4685): 1, (192, 2832): 1, (185, 2301): 1, (197, 5750): 1, (180, 2565): 1, (200, 3803): 1, (178, 3816): 1, (181, 2485): 2, (181, 2178): 1, (200, 2578): 1, (200, 2571): 1, (199, 2676): 1, (186, 2335): 1, (185, 4167): 1, (200, 5062): 2, (167, 2499): 2, (182, 2729): 1, (200, 2619): 1, (192, 4019): 1, (211, 2612): 2, (210, 3812): 1, (194, 3010): 1, (194, 3004): 1, (169, 2854): 1, (177, 3442): 1, (177, 3449): 1, (178, 2261): 1, (183, 1343): 2, (169, 2570): 1}, 'Up-Dn-time': {(0.0, 0.02): 1, (1.03, 0.08): 1, (0.22, 0.02): 1, (0.3, 0.05): 1, (0.81, 0.05): 1, (-0.62, 0.01): 1, (0.11, 0.01): 1, (0.11, 0.02): 1, (0.0, 0.07): 1, (0.02, 0.03): 1, (0.76, 0.0): 1, (0.07, 0.03): 1, (0.12, 0.08): 1, (0.1, 0.0): 1, (0.04, 0.01): 1, (0.06, 0.02): 1, (0.69, 0.0): 1, (-0.51, 0.03): 1, (0.05, 0.04): 1, (0.01, 0.0): 1, (0.11, 0.04): 1, (0.13, 0.0): 1, (0.0, 0.11): 2, (0.0, 0.0): 2, (0.09, 0.01): 1, (0.01, 0.04): 1, (0.09, 0.3): 1, (0.27, -0.42): 1, (0.0, 0.01): 1, (0.01, 0.11): 1, (0.01, 0.1): 1, (0.0, 0.03): 1, (0.06, 0.0): 1, (0.05, 0.09): 1, (0.1, 0.01): 1, (0.59, 0.36): 1, (-0.68, 0.01): 1, (1.32, 0.02): 1}, 'Uni-size': {167: 3, 1425: 1, 176: 1, 2317: 1, 184: 1, 2988: 1, 191: 2, 2014: 1, 197: 2, 1862: 1, 173: 1, 7616: 1, 4685: 1, 192: 2, 2832: 1, 185: 2, 2301: 1, 5750: 1, 180: 1, 2565: 1, 200: 6, 3803: 1, 178: 2, 3816: 1, 181: 3, 2485: 2, 2178: 1, 2578: 1, 2571: 1, 199: 1, 2676: 1, 186: 1, 2335: 1, 4167: 1, 5062: 2, 2499: 2, 182: 1, 2729: 1, 2619: 1, 4019: 1, 211: 2, 2612: 2, 210: 1, 3812: 1, 194: 2, 3010: 1, 3004: 1, 169: 2, 2854: 1, 177: 2, 3442: 1, 3449: 1, 2261: 1, 183: 2, 1343: 2, 2570: 1}, 'Uni-time': {0.0: 16, 0.02: 6, 1.03: 1, 0.08: 2, 0.22: 1, 0.3: 2, 0.05: 4, 0.81: 1, -0.62: 1, 0.01: 11, 0.11: 6, 0.07: 2, 0.03: 4, 0.76: 1, 0.12: 1, 0.1: 3, 0.04: 4, 0.06: 2, 0.69: 1, -0.51: 1, 0.13: 1, 0.09: 3, 0.27: 1, -0.42: 1, 0.59: 1, 0.36: 1, -0.68: 1, 1.32: 1}, 'Pkt-size': {167: 3, 1425: 1, 176: 1, 1448: 56, 4: 18, 8: 2, 857: 1, 184: 1, 9: 15, 78: 1, 5: 15, 191: 2, 566: 1, 197: 2, 414: 1, 173: 1, 14: 1, 1265: 1, 545: 1, 333: 1, 192: 2, 1375: 1, 185: 2, 600: 8, 253: 1, 206: 1, 180: 1, 1103: 1, 200: 6, 889: 1, 178: 2, 320: 1, 181: 3, 1023: 1, 1033: 1, 721: 1, 1121: 1, 1114: 1, 199: 1, 1219: 1, 186: 1, 878: 1, 1258: 1, 16: 1, 689: 1, 702: 1, 1042: 1, 1037: 1, 182: 1, 1267: 1, 1157: 1, 519: 1, 211: 2, 1150: 2, 210: 1, 861: 1, 903: 1, 194: 2, 17: 2, 93: 1, 956: 1, 169: 2, 806: 1, 177: 2, 542: 1, 532: 1, 799: 1, 183: 2, 1343: 2, 1113: 1}}

```
向量化的过程:
- 1. 获取全局的字典：
线性遍历每条流的BIND-Feature-Raw,获取7类特征的字典,字典反映了各类特征可能出现那些取值。

如果取值太大了,可能安装频率的高低只保留频率TOPN的一些取值。

- 2. 向量化
根据全局的特征字典,只保留每条流里面存在于全局特征字典key里面的key.
例如，假设全局化字典里面的'Dn-Up-Burst-Size'特征，一共保留了512个key.
那么每条流的'Dn-Up-Burst-Size'特征就是一个512维的向量,其中第i个向量的取值表示第i个key在这条流出现的次数。
为了防止流的长度为特征取值的影响,这512维特征会除以这条流Dn-Up-Burst-Size里面所有value的总和。

最后把7类特征拼接起来，得到最终的向量特征。
